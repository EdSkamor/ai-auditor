<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <title>AI Auditor — Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: system-ui, sans-serif; margin: 2rem; max-width: 900px }
    textarea { width: 100%; height: 160px; }
    pre { background: #f6f8fa; padding: 1rem; white-space: pre-wrap; }
    button { padding: .6rem 1rem; cursor: pointer; }
    .row { display: flex; gap: 1rem; align-items: center; }
  </style>
</head>
<body>
  <h1>AI Auditor — Demo</h1>
  <p>Wklej zapytanie (np. krótki opis sytuacji finansowej). Odpowiedzi zawsze po polsku.</p>

  <textarea id="prompt">Spadek przychodów 40% r/r, zadłużenie z 30% do 65%: wskaż 3–5 ryzyk i działania.</textarea>
  <div class="row">
    <label>max_new_tokens: <input id="mnt" type="number" value="220" min="32" max="1024"></label>
    <label><input id="sample" type="checkbox"> losowe (sampling)</label>
    <button id="run">Analizuj</button>
  </div>

  <h3>Wynik</h3>
  <pre id="out">—</pre>

  <script>
    const run = document.getElementById("run");
    run.onclick = async () => {
      const prompt = document.getElementById("prompt").value.trim();
      const max_new_tokens = parseInt(document.getElementById("mnt").value || "220", 10);
      const do_sample = document.getElementById("sample").checked;

      document.getElementById("out").textContent = "Pracuję…";
      try {
        const res = await fetch("/analyze", {
          method: "POST",
          headers: {"Content-Type":"application/json"},
          body: JSON.stringify({ prompt, max_new_tokens, do_sample })
        });
        const json = await res.json();
        document.getElementById("out").textContent = json.output || JSON.stringify(json, null, 2);
      } catch (e) {
        document.getElementById("out").textContent = "Błąd: " + e;
      }
    };
  </script>
</body>
</html>
